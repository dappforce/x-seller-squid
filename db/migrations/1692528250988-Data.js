module.exports = class Data1692528250988 {
    name = 'Data1692528250988'

    async up(db) {
        await db.query(`CREATE TABLE "transfer" ("id" character varying NOT NULL, "block_hash" text NOT NULL, "extrinsic_hash" text NOT NULL, "event_index" integer NOT NULL, "amount" numeric NOT NULL, "token" text, "address_chain_prefix" text, "from_id" character varying, "to_id" character varying, CONSTRAINT "PK_fd9ddbdd49a17afcbe014401295" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_76bdfed1a7eb27c6d8ecbb7349" ON "transfer" ("from_id") `)
        await db.query(`CREATE INDEX "IDX_0751309c66e97eac9ef1149362" ON "transfer" ("to_id") `)
        await db.query(`CREATE TABLE "domain_registration_order" ("id" character varying NOT NULL, "created_at_block" integer NOT NULL, "created_at_time" TIMESTAMP WITH TIME ZONE NOT NULL, "updated_at_block" integer, "updated_at_time" TIMESTAMP WITH TIME ZONE, "block_hash_seller_chain" text, "block_hash_uname_host_chain" text, "confirmed_block_hash_seller_chain" text, "confirmed_remark_call_id" text, "refund_block_hash_seller_chain" text, "refund_remark_call_id" text, "price" numeric, "token" text NOT NULL, "status" character varying(10), "refund_status" character varying(9), "purchase_rmrk" jsonb, "confirmation_rmrk" jsonb, "refund_rmrk" jsonb, "error_registration" jsonb, "error_refund" jsonb, "target_id" character varying, "domain_id" character varying, "purchase_tx_id" character varying, "refund_tx_id" character varying, CONSTRAINT "PK_a973261d7f8d195ba121a5f1d77" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_8e55a1ed8db328d762e6640786" ON "domain_registration_order" ("target_id") `)
        await db.query(`CREATE INDEX "IDX_2270f48590b35e98d6e164b608" ON "domain_registration_order" ("domain_id") `)
        await db.query(`CREATE INDEX "IDX_cf3f403c43744050262e9b6bfd" ON "domain_registration_order" ("purchase_tx_id") `)
        await db.query(`CREATE INDEX "IDX_ccb5293b2892ce7d56eaa31c77" ON "domain_registration_order" ("refund_tx_id") `)
        await db.query(`CREATE TABLE "energy_box" ("id" character varying NOT NULL, "block_hash_seller_chain" text, "block_hash_energy_host_chain" text, "energy_amount" numeric NOT NULL, "box_price" numeric NOT NULL, "token" text NOT NULL, "status" character varying(10), "refund_status" character varying(9), "generation_rmrk" jsonb, "confirmation_rmrk" jsonb, "refund_rmrk" jsonb, "error_generation" jsonb, "error_refund" jsonb, "owner_id" character varying, "purchase_tx_id" character varying, "refund_tx_id" character varying, CONSTRAINT "PK_b3c52bb9654ab46dab275c806c6" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_d4663815e8ad21cf78db938549" ON "energy_box" ("owner_id") `)
        await db.query(`CREATE INDEX "IDX_6a7313614d71594cbc720bec55" ON "energy_box" ("purchase_tx_id") `)
        await db.query(`CREATE INDEX "IDX_05b6986250015fd1d92647ff0c" ON "energy_box" ("refund_tx_id") `)
        await db.query(`CREATE TABLE "account" ("id" character varying NOT NULL, CONSTRAINT "PK_54115ee388cdb6d86bb4bf5b2ea" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "domain" ("id" character varying NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE, "created_at_block" integer, "owner_id" character varying, CONSTRAINT "PK_27e3ec3ea0ae02c8c5bceab3ba9" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_4e21006496ef49995f4cf5ff8c" ON "domain" ("owner_id") `)
        await db.query(`CREATE TABLE "processing_state" ("id" character varying NOT NULL, "domain_reg_refund_full_processing_at_block" integer NOT NULL, CONSTRAINT "PK_8363abc3a4f4d8e3a90ccaeee59" PRIMARY KEY ("id"))`)
        await db.query(`ALTER TABLE "transfer" ADD CONSTRAINT "FK_76bdfed1a7eb27c6d8ecbb73496" FOREIGN KEY ("from_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer" ADD CONSTRAINT "FK_0751309c66e97eac9ef11493623" FOREIGN KEY ("to_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "domain_registration_order" ADD CONSTRAINT "FK_8e55a1ed8db328d762e6640786e" FOREIGN KEY ("target_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "domain_registration_order" ADD CONSTRAINT "FK_2270f48590b35e98d6e164b6082" FOREIGN KEY ("domain_id") REFERENCES "domain"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "domain_registration_order" ADD CONSTRAINT "FK_cf3f403c43744050262e9b6bfd1" FOREIGN KEY ("purchase_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "domain_registration_order" ADD CONSTRAINT "FK_ccb5293b2892ce7d56eaa31c777" FOREIGN KEY ("refund_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "energy_box" ADD CONSTRAINT "FK_d4663815e8ad21cf78db9385494" FOREIGN KEY ("owner_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "energy_box" ADD CONSTRAINT "FK_6a7313614d71594cbc720bec55f" FOREIGN KEY ("purchase_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "energy_box" ADD CONSTRAINT "FK_05b6986250015fd1d92647ff0c7" FOREIGN KEY ("refund_tx_id") REFERENCES "transfer"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "domain" ADD CONSTRAINT "FK_4e21006496ef49995f4cf5ff8c4" FOREIGN KEY ("owner_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "transfer"`)
        await db.query(`DROP INDEX "public"."IDX_76bdfed1a7eb27c6d8ecbb7349"`)
        await db.query(`DROP INDEX "public"."IDX_0751309c66e97eac9ef1149362"`)
        await db.query(`DROP TABLE "domain_registration_order"`)
        await db.query(`DROP INDEX "public"."IDX_8e55a1ed8db328d762e6640786"`)
        await db.query(`DROP INDEX "public"."IDX_2270f48590b35e98d6e164b608"`)
        await db.query(`DROP INDEX "public"."IDX_cf3f403c43744050262e9b6bfd"`)
        await db.query(`DROP INDEX "public"."IDX_ccb5293b2892ce7d56eaa31c77"`)
        await db.query(`DROP TABLE "energy_box"`)
        await db.query(`DROP INDEX "public"."IDX_d4663815e8ad21cf78db938549"`)
        await db.query(`DROP INDEX "public"."IDX_6a7313614d71594cbc720bec55"`)
        await db.query(`DROP INDEX "public"."IDX_05b6986250015fd1d92647ff0c"`)
        await db.query(`DROP TABLE "account"`)
        await db.query(`DROP TABLE "domain"`)
        await db.query(`DROP INDEX "public"."IDX_4e21006496ef49995f4cf5ff8c"`)
        await db.query(`DROP TABLE "processing_state"`)
        await db.query(`ALTER TABLE "transfer" DROP CONSTRAINT "FK_76bdfed1a7eb27c6d8ecbb73496"`)
        await db.query(`ALTER TABLE "transfer" DROP CONSTRAINT "FK_0751309c66e97eac9ef11493623"`)
        await db.query(`ALTER TABLE "domain_registration_order" DROP CONSTRAINT "FK_8e55a1ed8db328d762e6640786e"`)
        await db.query(`ALTER TABLE "domain_registration_order" DROP CONSTRAINT "FK_2270f48590b35e98d6e164b6082"`)
        await db.query(`ALTER TABLE "domain_registration_order" DROP CONSTRAINT "FK_cf3f403c43744050262e9b6bfd1"`)
        await db.query(`ALTER TABLE "domain_registration_order" DROP CONSTRAINT "FK_ccb5293b2892ce7d56eaa31c777"`)
        await db.query(`ALTER TABLE "energy_box" DROP CONSTRAINT "FK_d4663815e8ad21cf78db9385494"`)
        await db.query(`ALTER TABLE "energy_box" DROP CONSTRAINT "FK_6a7313614d71594cbc720bec55f"`)
        await db.query(`ALTER TABLE "energy_box" DROP CONSTRAINT "FK_05b6986250015fd1d92647ff0c7"`)
        await db.query(`ALTER TABLE "domain" DROP CONSTRAINT "FK_4e21006496ef49995f4cf5ff8c4"`)
    }
}
